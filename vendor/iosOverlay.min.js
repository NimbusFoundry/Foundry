/*global $*//*jshint unused:false,forin:false*/var iosOverlay=function(e){"use strict";var t,n=function(){},r={onbeforeshow:n,onshow:n,onbeforehide:n,onhide:n,text:"",icon:null,spinner:null,duration:null,id:null,parentEl:null},i=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var i in t)n[i]=t[i];return n},s=function(){var e=document.body||document.documentElement,t=e.style,n="transition";if(typeof t[n]=="string")return!0;var r=["Moz","Webkit","Khtml","O","ms"];n=n.charAt(0).toUpperCase()+n.substr(1);for(var i=0;i<r.length;i++)if(typeof t[r[i]+n]=="string")return!0;return!1}(),o=i(r,e),u=function(e){e.animationName==="ios-overlay-show"&&o.onshow();if(e.animationName==="ios-overlay-hide"){l();o.onhide()}},a=function(){t=document.createElement("div");t.className="ui-ios-overlay";t.innerHTML+='<span class="title">'+o.text+"</span";e.icon?t.innerHTML+='<img src="'+e.icon+'">':e.spinner&&t.appendChild(e.spinner.el);if(s){t.addEventListener("webkitAnimationEnd",u,!1);t.addEventListener("msAnimationEnd",u,!1);t.addEventListener("oAnimationEnd",u,!1);t.addEventListener("animationend",u,!1)}e.parentEl?document.getElementById(e.parentEl).appendChild(t):document.body.appendChild(t);o.onbeforeshow();s?t.className+=" ios-overlay-show":typeof $=="function"&&$(t).fadeIn({duration:200},function(){o.onshow()});o.duration&&window.setTimeout(function(){f()},o.duration)}(),f=function(){o.onbeforehide();s?t.className=t.className.replace("show","hide"):typeof $=="function"&&$(t).fadeOut({duration:200},function(){l();o.onhide()})},l=function(){e.parentEl?document.getElementById(e.parentEl).removeChild(t):document.body.removeChild(t)},c=function(e){e.text&&(t.getElementsByTagName("span")[0].innerHTML=e.text);if(e.icon){o.spinner&&o.spinner.el.parentNode.removeChild(o.spinner.el);t.innerHTML+='<img src="'+e.icon+'">'}};return{hide:f,destroy:l,update:c}};